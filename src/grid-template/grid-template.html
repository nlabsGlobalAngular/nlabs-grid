<title>Data Grid Component</title>

<!-- 
  ============================================
  GRID GENİŞLİĞİ AYARLAMA ÖRNEKLERİ
  ============================================
  
  Grid'in genişliğini ayarlamak için [width] ve [maxWidth] input'larını kullanın:
  
  ÖRNEK 1: Tam Genişlik (Varsayılan)
  <app-data-grid
      [width]="'100%'"
      [maxWidth]="'100%'"
  >
  
  ÖRNEK 2: Sabit Genişlik (1400px)
  <app-data-grid
      [width]="'100%'"
      [maxWidth]="'1400px'"
  >
  
  ÖRNEK 3: Dar Grid (1200px)
  <app-data-grid
      [width]="'100%'"
      [maxWidth]="'1200px'"
  >
  
  ÖRNEK 4: Geniş Grid (1800px)
  <app-data-grid
      [width]="'100%'"
      [maxWidth]="'1800px'"
  >
  
  ÖRNEK 5: Ekranın Yüzdesi (%80)
  <app-data-grid
      [width]="'80%'"
      [maxWidth]="'100%'"
  >
  
  ÖRNEK 6: Viewport Genişliği (90vw)
  <app-data-grid
      [width]="'90vw'"
      [maxWidth]="'100%'"
  >
  
  ÖRNEK 7: Tam Sabit (800px)
  <app-data-grid
      [width]="'800px'"
      [maxWidth]="'800px'"
  >
  
  ÖRNEK 8: Component'ten Değişken Kullanma (DİNAMİK)
  TypeScript'te: 
    gridWidth = '100%';
    gridMaxWidth = '1500px';
  
  HTML'de:
  <app-data-grid
      [width]="gridWidth"
      [maxWidth]="gridMaxWidth"
  >
  
  Böylece TypeScript'ten değiştirerek responsive yapabilirsiniz:
    changeGridSize(size: 'small' | 'medium' | 'large') {
      if (size === 'small') this.gridMaxWidth = '1200px';
      else if (size === 'medium') this.gridMaxWidth = '1400px';
      else this.gridMaxWidth = '1800px';
    }
  
  NOT: Container'a style eklemek isterseniz:
  <div class="grid-container" style="max-width: 1400px; margin: 0 auto;">
  ============================================
-->

<div class="grid-container">
  <h1>Nlabs Angular DataGrid Project</h1>
  <p>Total Records: {{ gridData.length }}</p>
  
  <!-- 
    ŞU ANDA KULLANILAN: width="100%", maxWidth="1400px"
    Değiştirmek için: [maxWidth] değerini değiştirin (örn: '1200px', '1600px', '100%')
  -->
  <app-data-grid
      [data]="gridData"
      [columns]="columns"
      [config]="gridConfig"
      [theme]="'auto'"
      [width]="'100%'"
      [maxWidth]="'2300px'"
      [showAddButton]="true"
      (dataStateChange)="onDataStateChange($event)"
      (onEdit)="openEditModal($event)"
      (onDelete)="openDeleteModal($event)"
      (onAdd)="openAddModal()"
      (onSelectionChange)="onSelectionChanged($event)"
  >
    <!-- Custom Cell Template for Customer Column -->
    <ng-template gridCellTemplate="customer" let-row let-column="column">
      @if (editingRow && editingRow.id === row.id) {
        <!-- Inline Edit Mode -->
        <input type="text" 
               [(ngModel)]="editingRow.customer" 
               class="form-control"
               style="width: 100%; padding: 6px 10px;">
      } @else {
        <!-- Display Mode -->
        <div style="display: flex; align-items: center; gap: 8px;">
          <span style="
            width: 32px;
            height: 32px;
            border-radius: 50%;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 14px;
          ">
            {{ row.customer.charAt(0) }}
          </span>
          <span style="font-weight: 600; color: var(--text-primary);">
            {{ row.customer }}
          </span>
        </div>
      }
    </ng-template>

    <!-- Custom Cell Template for Freight Column -->
    <ng-template gridCellTemplate="freight" let-row let-column="column">
      @if (editingRow && editingRow.id === row.id) {
        <!-- Inline Edit Mode -->
        <input type="number" 
               [(ngModel)]="editingRow.freight" 
               step="0.01"
               class="form-control"
               style="width: 100%; padding: 6px 10px;">
      } @else {
        <!-- Display Mode -->
        <div style="
          display: flex;
          align-items: center;
          gap: 8px;
          padding: 4px 0;
        ">
          @if (row.freight > 100) {
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="#ef4444" stroke-width="2">
              <path d="M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z"/>
              <line x1="12" y1="9" x2="12" y2="13"/>
              <line x1="12" y1="17" x2="12.01" y2="17"/>
            </svg>
          } @else if (row.freight > 50) {
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="#f59e0b" stroke-width="2">
              <circle cx="12" cy="12" r="10"/>
              <line x1="12" y1="8" x2="12" y2="12"/>
              <line x1="12" y1="16" x2="12.01" y2="16"/>
            </svg>
          } @else {
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="#10b981" stroke-width="2">
              <polyline points="20 6 9 17 4 12"/>
            </svg>
          }
          <span [style.color]="row.freight > 100 ? '#ef4444' : row.freight > 50 ? '#f59e0b' : '#10b981'"
                [style.font-weight]="'700'">
            ${{ row.freight.toFixed(2) }}
          </span>
        </div>
      }
    </ng-template>

    <!-- Custom Footer Template for Freight Column -->
    <ng-template gridFooterTemplate="freight" let-data="data" let-column="column">
      <div style="
        display: flex;
        flex-direction: column;
        gap: 2px;
        font-size: 12px;
      ">
        <div style="font-weight: 700; color: var(--primary-color);">
          Total: ${{ calculateTotal(data, 'freight') }}
        </div>
        <div style="color: var(--text-secondary);">
          Avg: ${{ calculateAverage(data, 'freight') }}
        </div>
      </div>
    </ng-template>

    <!-- Custom Footer Template for Customer Column -->
    <ng-template gridFooterTemplate="customer" let-data="data">
      <div style="
        background: linear-gradient(135deg, #667eea20 0%, #764ba220 100%);
        padding: 6px 12px;
        border-radius: 6px;
        font-weight: 600;
        color: #667eea;
        text-align: center;
      ">
        {{ data.length }} Customers
      </div>
    </ng-template>

    <!-- Custom Cell Template for Actions Column -->
    <ng-template gridCellTemplate="actions" let-row>
      <div class="action-buttons">
        @if (editingRow && editingRow.id === row.id) {
          <!-- Inline Editing Mode: Save & Cancel -->
          <button class="btn btn-sm btn-save" 
                  (click)="saveEdit(row)"
                  title="Save Changes">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z"/>
              <polyline points="17 21 17 13 7 13 7 21"/>
              <polyline points="7 3 7 8 15 8"/>
            </svg>
            <span class="btn-text">Kaydet</span>
          </button>
          <button class="btn btn-sm btn-cancel" 
                  (click)="cancelEdit()"
                  title="Cancel Editing">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <line x1="18" y1="6" x2="6" y2="18"/>
              <line x1="6" y1="6" x2="18" y2="18"/>
            </svg>
            <span class="btn-text">İptal</span>
          </button>
        } @else {
          <!-- Normal Mode: Quick Edit (Inline) & Modal Edit & Delete -->
          <button class="btn btn-sm btn-edit" 
                  (click)="startEdit(row)"
                  title="Quick Edit (in row)">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"/>
              <path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"/>
            </svg>
            <span class="btn-text">Hızlı</span>
          </button>
          <button class="btn btn-sm" 
                  (click)="openEditModal(row)"
                  title="Edit in Modal (detailed)"
                  style="background: linear-gradient(135deg, #43e97b 0%, #38f9d7 100%); color: white;">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <rect x="3" y="3" width="18" height="18" rx="2" ry="2"/>
              <line x1="9" y1="9" x2="15" y2="9"/>
              <line x1="9" y1="15" x2="15" y2="15"/>
            </svg>
            <span class="btn-text">Detaylı</span>
          </button>
          <button class="btn btn-sm btn-delete" 
                  (click)="openDeleteModal(row)"
                  title="Delete Record">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <polyline points="3 6 5 6 21 6"/>
              <path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"/>
              <line x1="10" y1="11" x2="10" y2="17"/>
              <line x1="14" y1="11" x2="14" y2="17"/>
            </svg>
            <span class="btn-text">Sil</span>
          </button>
        }
      </div>
    </ng-template>

    <!-- Modal Content: Edit Record -->
    @if (showEditModal) {
      <div gridModalContent>
        <form (ngSubmit)="saveEditModal()">
          <div class="form-group">
            <label>Müşteri Adı</label>
            <input type="text" [(ngModel)]="selectedRow.customer" name="customer" required class="form-control">
          </div>
          <div class="form-group">
            <label>Sipariş Tarihi</label>
            <input type="date" [(ngModel)]="selectedRow.orderDate" name="orderDate" required class="form-control">
          </div>
          <div class="form-group">
            <label>Kargo Ücreti</label>
            <input type="number" [(ngModel)]="selectedRow.freight" name="freight" step="0.01" class="form-control">
          </div>
          <div class="form-group">
            <label>Ülke</label>
            <input type="text" [(ngModel)]="selectedRow.shipCountry" name="shipCountry" class="form-control">
          </div>
          <div class="form-group">
            <label>Kargo Şirketi</label>
            <input type="text" [(ngModel)]="selectedRow.shippingCompany" name="shippingCompany" class="form-control">
          </div>
          <div class="modal-actions">
            <button type="submit" class="btn btn-save">
              <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z"/>
                <polyline points="17 21 17 13 7 13 7 21"/>
                <polyline points="7 3 7 8 15 8"/>
              </svg>
              Değişiklikleri Kaydet
            </button>
            <button type="button" class="btn btn-cancel" (click)="closeModal()">
              <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <line x1="18" y1="6" x2="6" y2="18"/>
                <line x1="6" y1="6" x2="18" y2="18"/>
              </svg>
              İptal Et
            </button>
          </div>
        </form>
      </div>
    }

    <!-- Modal Content: Delete Confirmation -->
    @if (showDeleteModal) {
      <div gridModalContent>
        <div class="delete-confirmation">
          <div class="warning-icon">
            <svg xmlns="http://www.w3.org/2000/svg" width="40" height="40" viewBox="0 0 24 24" fill="none" stroke="#ef4444" stroke-width="2">
              <circle cx="12" cy="12" r="10"></circle>
              <line x1="12" y1="8" x2="12" y2="12"></line>
              <line x1="12" y1="16" x2="12.01" y2="16"></line>
            </svg>
          </div>
          <h4>Emin misiniz?</h4>
          <p>Bu kaydı gerçekten silmek istiyor musunuz? Bu işlem geri alınamaz.</p>
          <div class="record-info">
            <div class="info-row">
              <strong>Müşteri:</strong> <span>{{ selectedRow?.customer }}</span>
            </div>
            <div class="info-row">
              <strong>Sipariş Tarihi:</strong> <span>{{ selectedRow?.orderDate | date:'dd/MM/yyyy' }}</span>
            </div>
            <div class="info-row">
              <strong>Kargo Ücreti:</strong> <span>{{ selectedRow?.freight | currency:'TRY':'symbol':'1.2-2' }}</span>
            </div>
          </div>
          <div class="modal-actions">
            <button type="button" class="btn btn-danger" (click)="confirmDelete()">
              <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <polyline points="3 6 5 6 21 6"/>
                <path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"/>
                <line x1="10" y1="11" x2="10" y2="17"/>
                <line x1="14" y1="11" x2="14" y2="17"/>
              </svg>
              Evet, Sil
            </button>
            <button type="button" class="btn btn-secondary" (click)="closeModal()">
              <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <line x1="18" y1="6" x2="6" y2="18"/>
                <line x1="6" y1="6" x2="18" y2="18"/>
              </svg>
              Hayır, İptal Et
            </button>
          </div>
        </div>
      </div>
    }

    <!-- Modal Content: Add New Record -->
    @if (showAddModal) {
      <div gridModalContent>
        <form (ngSubmit)="saveNewRow()">
          <div class="form-group">
            <label>Müşteri Adı</label>
            <input type="text" [(ngModel)]="newRow.customer" name="customer" required class="form-control">
          </div>
          <div class="form-group">
            <label>Sipariş Tarihi</label>
            <input type="date" [(ngModel)]="newRow.orderDate" name="orderDate" required class="form-control">
          </div>
          <div class="form-group">
            <label>Kargo Ücreti</label>
            <input type="number" [(ngModel)]="newRow.freight" name="freight" step="0.01" class="form-control">
          </div>
          <div class="form-group">
            <label>Ülke</label>
            <input type="text" [(ngModel)]="newRow.shipCountry" name="shipCountry" class="form-control">
          </div>
          <div class="form-group">
            <label>Kargo Şirketi</label>
            <input type="text" [(ngModel)]="newRow.shippingCompany" name="shippingCompany" class="form-control">
          </div>
          <div class="modal-actions">
            <button type="submit" class="btn btn-add">
              <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M12 5v14M5 12h14"/>
              </svg>
              Yeni Kayıt Ekle
            </button>
            <button type="button" class="btn btn-secondary" (click)="closeModal()">
              <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <line x1="18" y1="6" x2="6" y2="18"/>
                <line x1="6" y1="6" x2="18" y2="18"/>
              </svg>
              İptal Et
            </button>
          </div>
        </form>
      </div>
    }

  </app-data-grid>
</div>
